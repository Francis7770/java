class Solution {
    Integer memo[][];
    int w1Len, w2Len;
    public int minDistance(String word1, String word2) {
        memo = new Integer[word1.length() + 1][word2.length() + 1];
        w1Len = word1.length();
        w2Len = word2.length();
        return minDistanceRecur(word1, word2, 0, 0);
    }

    int minDistanceRecur(String word1, String word2, int word1Index, int word2Index) {
        if (word1Index == w1Len) {
            // return how many remaining for word2
            return w2Len-word2Index;
        }
        if (word2Index == w2Len) {
            // return how many remaining for word1
            return w1Len-word1Index;
        }
        if (memo[word1Index][word2Index] != null) {
            return memo[word1Index][word2Index];
        }
        int minEditDistance = 0;
        if (word1.charAt(word1Index) == word2.charAt(word2Index)) {
            minEditDistance = minDistanceRecur(word1, word2, word1Index + 1, word2Index + 1);
        }
        else {
            // insert in word1 or, delete from word1
            int insertOperation = minDistanceRecur(word1, word2, word1Index + 1, word2Index);
            // delete from word2 or, insert in word2
            int deleteOperation = minDistanceRecur(word1, word2, word1Index, word2Index+1);
            // replace so, the i'th index of both word1 and word2 becomes equal. Now we move to i+1 th index for both.
            int replaceOperation = minDistanceRecur(word1, word2, word1Index + 1, word2Index + 1);
            minEditDistance = Math.min(insertOperation, Math.min(deleteOperation, replaceOperation)) + 1;
        }
        memo[word1Index][word2Index] = minEditDistance;
        return minEditDistance;
    }
}
